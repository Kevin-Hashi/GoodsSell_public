# システムの使い方

## 1.フォーム作成

新規をクリックします。
![picture 3](images/ae2ca6ed7cab752e9b69686a44eb7e743a7509cfd12569a1d58cc13731cdb5dd.png)

新しいフォルダをクリックします。
![picture 4](images/e5063f95f6aa7f147ede20d69a181c5641ab305eaea798e634c42116663336e7.png)

名前を変更して作成します。
おすすめは年度です。
![picture 5](images/022d70e8d0b88dd618980c8b4a55a49f66ce274a7c62e6653d1d5018a1b4b4ac.png)
![picture 6](images/6f3c4e24e162b04cc16f26459658790590ab9cb3cdeddf2b096c34c67643ae7e.png)

作成したフォルダに入ります。(今回は2023)
同様にして「体実」フォルダを作ります。

![picture 1](images/ea8da35bba84aecdd3321e93314f53ffa0a042f2b24d5aa5ce08e0e692d4d87e.png)

マイドライブまで戻り、テンプレートに入ります。
![picture 9](images/0aa4a00141d5cebcfbb628bfa2759bff4022ab3d07f11310e403bf09278eda9f.png)

以降の操作で「文化祭」と写真に表示しているものは「体育祭」と読み替えてください。基本的な操作は同じです。
「体育祭Tシャツ」の方を右クリック→コピーします。
![picture 10](images/e6635bd7e123ccd52b35b221ed28dcab706f7e58ce292ea820ebc5f370494093.png)

「...のコピー」と書いてあるほうを選択します。
右クリック→指定の場所に移動をクリックします。
![picture 11](images/b157c055d6e4d1d762b32c2898a62f8fae05bb113ea66797f210920ee3da5ce7.png)
画面の指示に従って作成したフォルダまで移動します。
最後に「ここに移動」をクリックします。
![picture 12](images/aa41fee493beedeff3198bf22f77d32bcdf10c4400d73855f8131f87923b388e.png)
![picture 13](images/521b8e64d1858032f860cb57d48ca0e2f757bc34206088b8470fb0af2c296be2.png)
![picture 14](images/bf966e372247494689cd280998fc440edaa3d3227631480fd5da4fb247fb64d9.png)

## 2.スプレッドシート作成

図の位置まで移動します。
![picture 21](images/ae59bb49db028566ece24cc5303d60d50365db9537edd881897de9cee4cfdc74.png)
このように「注文番号」「購入済み」を追加します。
![picture 22](images/5b3033ed90b9638f3c6099f91c9e6f51bb77f1016fb71c21f0cdaa3c24be593f.png)

シートを追加→クリック→名前の変更の順に操作を行い、「アイテム一覧」「アイテムグループ」「プロパティ」「使用済み注文番号」のシートを作成します。
![picture 23](images/2628c62e0e9acf7f9aa5f2b9281489b0008410eac4f9131c4bfa6b32e98f67ce.png)

使用済み注文番号には一番上に最初の注文番号-1を入れておきます。20230000とかにしておきます。すると20230001から始まります。

そのほかのシートには次の表をコピーしてCtrl+shift+vで貼り付けます。
|                  |             |      |        |
| ---------------- | ----------- | ---- | ------ |
| アイテムグループ | アイテム名  | 値段 | サイズ |
| Tシャツ          | 白×黒       | 1000 | M      |
| Tシャツ          | 白×黒       | 1000 | L      |
| Tシャツ          | 白×黒       | 1000 | XL     |
| Tシャツ          | 黒×赤       | 1000 | M      |
| Tシャツ          | 黒×赤       | 1000 | L      |
| Tシャツ          | 黒×赤       | 1000 | XL     |
| Tシャツ          | 黄×青       | 1000 | M      |
| Tシャツ          | 黄×青       | 1000 | L      |
| Tシャツ          | 黄×青       | 1000 | XL     |
| Tシャツ          | 紫×緑       | 1000 | M      |
| Tシャツ          | 紫×緑       | 1000 | L      |
| Tシャツ          | 紫×緑       | 1000 | XL     |
| Tシャツ          | ネイビー×白 | 1000 | M      |
| Tシャツ          | ネイビー×白 | 1000 | L      |
| Tシャツ          | ネイビー×白 | 1000 | XL     |
| Tシャツ          | 緑×黄緑     | 1000 | M      |
| Tシャツ          | 緑×黄緑     | 1000 | L      |
| Tシャツ          | 緑×黄緑     | 1000 | XL     |

|                  |            |        |        |
| ---------------- | ---------- | ------ | ------ |
| アイテムグループ | アイテム名 | サイズ | タイプ |
| Tシャツ          | 5,7,9      | 6,8,10 | 名前   |

|                |     |
| -------------- | --- |
| 購入済み       | 13  |
| 注文番号       | 12  |
| 名前           | 2   |
| メールアドレス | 3   |
| 学籍番号       | 1   |
| タイムスタンプ | 0   |

<details><summary>解説</summary>
<div>

- アイテム一覧の表
  - アイテムグループの列はアイテムグループに登録されている名前をさします。詳しくは事項を参照してください。
  - アイテム名の列はスプレッドシートに記録される商品名です。コピーするなどしてまったく同じにしてください。少しでも違うと動きません。
  - 値段の列には値段が入っています。
    サイズの列は商品のバリエーションをさします。多くの場合でサイズをさします。何もない場合は空欄にしてください。
- アイテムグループの表
  - アイテムグループに登録する名前を入力します。任意の名前ですが、わかりやすいほうがいいでしょう。
  - アイテム名、サイズの列は、それぞれがどの列に記入されるかを入力します。一番端の列が0になります。カンマ区切りで入力してください。
  - タイプの列は、その商品がどのように記録されるかを入力します。Tシャツなどのようにアイテム名とサイズが記入されてその数を数えるものは「名前」、メモ帳のように個数が記録されるものは「個数」と書きます。
- プロパティの表
  - それぞれの設定がどの列に記入されるかです。

</div>

</details>

## 3.スクリプトの作成

フォームの画面に戻ります。
右上の3点リーダー→スクリプトエディタをクリックします。
![picture 24](images/62050f65b7d623d1834b8437598e9e1286519e90445049b8cf2daffed1b04336.png)

すでにテンプレがあります。
![picture 25](images/eb2950697af955bb0b6fe56cc2cb8d4f3cb39c321d5c1ba12ec52dda1cfe6a6b.png)

この2つを変更します。
![picture 26](images/28538c79665bd8cc7d9fdb3f855fb2ac32d5877034683f0cd96a124269272e19.png)
シートIDはこの部分です。
![picture 27](images/057e5e99fbe2c508e1555a2f063b3d50eabc85927791e4eb153792a7d5b7b871.png)
今回だと1WkS901MH9o7T82iwRAfWySO14YPuZ90p3PR0HEQVntYです。
`contact`は担当者の連絡先です。
変更後がこれです。
![picture 28](images/0d488076f4d7eadc499f02878ca80cdb6e8a8427f5925fca8b6734a70f3342a3.png)

myFunctionを選択して実行を押します。
![picture 2](images/c2733b4492d1e2a55108f14a91eea814f0e9e1d81d8502d7bff211e2d902ad40.png)
権限を確認を押します。
![picture 3](images/2bcca2d767c440ee84d0ae1d5ea3565d66e4b78ff80b7b2cbe314475cc387bd3.png)
アカウント名をクリックします。
![picture 4](images/7e50cc1e8636f147490121e1f1ca3b23cfaa0e79f203a7cfa0d4dfc2e346d455.png)
詳細をクリックします。
![picture 5](images/8ca6c70588ed6c29133640c9e90df8c86ce12bb43a35b98d8a71b589c6a72d88.png)
無題のプロジェクトに移動を押します。
![picture 6](images/1e037d983aa9049e96f4c71b150fc70164dbd32fa5b4b28bc141c8df4ca16e2f.png)
許可を押します。
![picture 7](images/21348f8d5925f90d5ed5fd9028add6ffc712e16c4fd1c93069c96ea923cc7ab8.png)

これで完成です。

注文の受付を終了したら横のトリガーから、すべてのトリガーを削除してください。

## 4.販売システムの使い方

<https://urakosai.net/sales4staff>にアクセスしてください。
![picture 35](images/36c5453843a8fc4ee662afdc90a6c91432054e64ecefb007ac95ab70eba5dec3.png)

シートIDを入力します。
![picture 36](images/1a1b8010dc8cb64e327b55cca8098e0aef1a31548ef8fc68b855161be3ce40dd.png)
ボタンを押して次のページに進みます。
シート名を入力します。変更ないならボタンを押します。
![picture 37](images/1017317600006bc8660b22bb536585e0582db89d9cb7d228e6e14cd17a916747.png)
読み込みが終わると次の画面に変わります。
![picture 38](images/4cb2f213fba9a8dfade71d7e4d01cb1827d438a348c6dbf9fb1be439923b2c20.png)
あとはQRコードを読み込むだけです。
するとこの画面が出てきます。
![picture 39](images/16898ea811a79e86f9254bfaf63ea52265edd9d47a01ccc3103a7a936c328826.png)
ACCEPTを押すとシートの購入済みの欄にマークがつきます。
REJECTを押すとマークがつきません。

<details><summary>QRコードについて</summary>
<div>

物理科に聞いた話ですが、学校にQRコードリーダーが配備されたようです。教員にいえば貸してくれるでしょう。もし普通の先生がわからないと言っても、物理科の鹿島先生や南先生に「75期の橋口の引継ぎに書いてありました」といえば多分わかってくれます。
QRコードリーダーはBluetoothの接続とレシーバーを使用した接続があります。楽なのは後者ですが、もしパソコンにUSBのポートがない場合はBluetoothで接続してください。
詳しくはQRコードリーダーについてを読んでください。
</div></details>
